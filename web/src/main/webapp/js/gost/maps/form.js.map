/* This file is generated — do not edit by hand! */
/* eslint-disable */
{"version":3,"sources":["form.js"],"names":["require","$form","$","$formFooterErrors","find","cr","orgStruct","dataSet","dataLength","personId","organId","emptyFields","orgFormAttachs","IMAGE","DOC","fieldsValue","organ","attributes","attachments","curatorGovernments","orgForm","checkInput","that","text","role","member","push","managerId","gostValidation","setAllValid","each","length","attr","data","val","is","next","children","tinymce","get","getBody","textContent","validateRequiredValues","validateValuesLength","fieldId","substring","indexOf","phone","extName","fileName","size","bytesToSize","uniqID","type","uuid","path","$select","$input","content","getContent","join","addFiles","document","on","$fileField","$previewContainer","parents","isPreviewField","allowedFormats","split","maxFiles","options","appId","portalName","appName","allowedFileFormats","constraints","maxFileCount","onClose","close","selectedFiles","RSTFileManager","getFiles","forEach","file","attach","transformToAttachmentsModel","resetPreview","renderPreview","open","bytes","sizes","i","parseInt","Math","floor","log","round","pow","isPreview","attachment","id","preview","displayName","extension","filter","item","ajax","headers","adminsHeaders","url","processData","contentType","fileInfo","empty","append","toLowerCase","requestForm","urlFunc","method","dataType","JSON","stringify","statusCode","window","location","href","redirectUrl","events","submit","e","preventDefault","scrollToFirstError","$fileContainer","closest","fileType","fileID","fileUID","remove","addPhone","$addPhone","$addPhoneBtn","parent","renderEditBox","linkText","addStructure","list","html","$addStructure","$addStructureBtn","structureBlockHeader","structureBlockBottom","structureBlock","selectmenu","editBox","hasClass","removeClass","hide","addClass","show","$dropdown","target","has","init","orgApp","tinyInit","selector","menubar","statusbar","relative_urls","image_advtab","mode","external_plugins","advlist","lists","link","visualchars","charmap","image","paste","plugins","toolbar1","body_class","language_url","content_css","versionUI","skin_url","advlist_bullet_styles","paste_use_dialog","paste_auto_cleanup_on_paste","paste_convert_headers_to_strong","paste_strip_class_attributes","paste_remove_spans","paste_remove_styles","paste_retain_style_properties","style_formats","title","items","block","format","setup","setUp","editor","addButton","icon","tooltip","onclick","insertContent","toFixed","$el","gostDatepicker","setTimeout","datepicker","parseDate","ready"],"mappings":"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","file":"../form.js","sourcesContent":["/* eslint-disable */\r\n/* global orgStruct, tinymce, $, gostValidation */\r\nrequire(['SHARED/jquery', 'SHARED/jqueryUI', 'SHARED/gostDatepicker', 'SHARED/tinymce', 'SHARED/gostValidation', 'SHARED/gostFileManager'], $ => {\r\n    const $form = $('#org-form');\r\n    const $formFooterErrors = $form.find('.js-formFooter-errors');\r\n    let cr = orgStruct.cr;\r\n    let dataSet = {};\r\n    let dataLength = {};\r\n    let personId = orgStruct.personId ? orgStruct.personId : null;\r\n    let organId = orgStruct.organId ? orgStruct.organId : null;\r\n    let emptyFields = [];\r\n    const orgFormAttachs = {\r\n        IMAGE: [],\r\n        DOC: [],\r\n    };\r\n\r\n    let fieldsValue = orgStruct.organ ? {} : {\r\n        attributes: [],\r\n        attachments: [],\r\n        curatorGovernments: []\r\n    };\r\n\r\n    const orgForm = {\r\n        checkInput: function () {\r\n            const that = this;\r\n            $formFooterErrors.text('');\r\n            emptyFields = [];\r\n            fieldsValue = Object.assign({}, orgStruct.organ ? {} : {\r\n                role: orgStruct.role,\r\n                attributes: [],\r\n                attachments: [],\r\n                curatorGovernments: []\r\n            }, orgStruct.member ? {\r\n                attachments: [],\r\n                organId: +organId\r\n            } : {});\r\n\r\n            if (personId) {\r\n                fieldsValue['id'] = personId\r\n            } else if (orgStruct.organ && organId) {\r\n                fieldsValue['id'] = organId\r\n            }\r\n\r\n            if (orgStruct.role === 'ADVISER') {\r\n                fieldsValue.attributes.push({\r\n                    'key': 'person',\r\n                    'value': orgStruct.managerId\r\n                });\r\n            }\r\n\r\n            gostValidation.setAllValid();\r\n\r\n            $form.find('[data-required]').each(function () {\r\n                if ($(this).find('select').length !== 0) {\r\n                    if ($(this).find('option:selected').attr('disabled') !== 'disabled') {\r\n                        dataSet[$(this).data('prop-name')] = $(this).find('select').val();\r\n                    } else {\r\n                        dataSet[$(this).data('prop-name')] = '';\r\n                        emptyFields.push($(this).find('select').data('key'));\r\n                    }\r\n                } else if ($(this).is('[data-attach]')) {\r\n                    if ($(this).next().children().length !== 0) {\r\n                        dataSet[$(this).data('prop-name')] = true;\r\n                    } else {\r\n                        dataSet[$(this).data('prop-name')] = '';\r\n                        emptyFields.push($(this).data('key'));\r\n                    }\r\n                } else {\r\n                    dataSet[$(this).data('prop-name')] = $(this).find('.form-field').val();\r\n\r\n                    if ($(this).find('.form-field').val() === '') {\r\n                        emptyFields.push($(this).find('.form-field').data('key'));\r\n                    }\r\n                }\r\n            });\r\n\r\n            $form.find('[data-max-length]').each(function () {\r\n                if ($(this).find('.js-tiny-editor').length !== 0) {\r\n                    dataLength[$(this).data('prop-name')] = tinymce.get($(this).find('.js-tiny-editor').attr('id')).getBody().textContent\r\n                } else {\r\n                    dataLength[$(this).data('prop-name')] = $(this).find('.form-field, .form-attr').val();\r\n                }\r\n            });\r\n\r\n            gostValidation.validateRequiredValues(dataSet);\r\n            gostValidation.validateValuesLength(dataLength);\r\n\r\n            $form.find('.form-field').each(function () {\r\n                let fieldId = $(this).attr('id').substring($(this).attr('id').indexOf('-') + 1);\r\n\r\n                if ($(this).val() !== '') {\r\n                    if ($(this).is('select')) {\r\n                        if ($(this).find('option:selected').attr('disabled') !== 'disabled') {\r\n                            fieldsValue[fieldId] = $(this).find('option:selected').text();\r\n                        }\r\n                    } else {\r\n                        if (fieldId === 'phone') {\r\n                            fieldsValue[fieldId] = fieldsValue.phone ? fieldsValue.phone + ', ' + $(this).val() : $(this).val();\r\n                        } else {\r\n                            fieldsValue[fieldId] = $(this).val();\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            $form.find('.form-attr').each(function () {\r\n                if ($(this).val() !== '') {\r\n                    if ($(this).is('select')) {\r\n                        fieldsValue.attributes.push({\r\n                            'key': $(this).data('key'),\r\n                            'value': $(this).find('option:selected').text()\r\n                        });\r\n                    } else {\r\n                        fieldsValue.attributes.push({\r\n                            'key': $(this).data('key'),\r\n                            'value': $(this).val()\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            $form.find('.form-attach').each(function () {\r\n                const attachments = [];\r\n\r\n                $('.gost-form__preview').each(function () {\r\n                    $(this).find('.preview-item').each(function () {\r\n                        attachments.push({\r\n                            extName: $(this).data('extension'),\r\n                            fileName: $(this).data('filename'),\r\n                            size: that.bytesToSize($(this).data('size')),\r\n                            uniqID: $(this).data('uniqid'),\r\n                            type: $(this).data('type'),\r\n                            uuid: $(this).data('uuid'),\r\n                            path: $(this).data('type') === 'IMAGE' ? `${cr}/image-api/view.ido?uuid=${$(this).data('uuid')}` : `${cr}/doc-api/view.ido?uuid=${$(this).data('uuid')}`\r\n                        });\r\n                    });\r\n                });\r\n\r\n                fieldsValue.attachments = attachments;\r\n            });\r\n\r\n            $form.find('.form-structure').each(function () {\r\n                let $select = $(this).find('select');\r\n                let $input = $(this).find('input');\r\n\r\n                fieldsValue.curatorGovernments.push({\r\n                    'id': null,\r\n                    'description': $input.val() !== '' ? $input.val() : '',\r\n                    'government': {\r\n                        'id': $select.find('option:selected').val()\r\n                    }\r\n                });\r\n            });\r\n\r\n            $form.find('.js-tiny-editor').each(function () {\r\n                let content = tinymce.get($(this).attr('id')).getContent();\r\n                let fieldId = $(this).attr('id').substring($(this).attr('id').indexOf('-') + 1);\r\n\r\n                if (content !== '') {\r\n                    if (orgStruct.organ) {\r\n                        fieldsValue[fieldId] = content;\r\n                    } else {\r\n                        fieldsValue.attributes.push({\r\n                            'key': $(this).data('key'),\r\n                            'value': content\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            $formFooterErrors.text(emptyFields.join(', '));\r\n        },\r\n\r\n\r\n        addFiles: function () {\r\n            const that = this;\r\n\r\n            $(document).on('click', '.js-add-file', function () {\r\n                const $fileField = $(this);\r\n                const $previewContainer = $fileField.parents('.gost-form__section').find('.gost-form__preview');\r\n                const isPreviewField = $fileField.attr('data-preview');\r\n                const allowedFormats = $fileField.attr('data-allowedFormats').split(', ');\r\n                const maxFiles = +$fileField.attr('data-maxFileCount');\r\n\r\n                const options = {\r\n                    appId: orgStruct.appId,\r\n                    portalName: orgStruct.portalName,\r\n                    appName: orgStruct.appName,\r\n                    allowedFileFormats: allowedFormats,\r\n                    constraints: {\r\n                        // max files count in FileManager is 20\r\n                        maxFileCount: maxFiles && maxFiles <= 20 ? maxFiles : 20,\r\n                    },\r\n                    onClose: function close() {\r\n                        const selectedFiles = RSTFileManager.getFiles();\r\n                        selectedFiles.forEach(function (file) {\r\n                            const attach = that.transformToAttachmentsModel(file, isPreviewField);\r\n                            if (isPreviewField === 'true') {\r\n                                that.resetPreview();\r\n                            }\r\n                            orgFormAttachs[attach.type].push(attach);\r\n                            that.renderPreview($previewContainer, attach);\r\n                        });\r\n                    },\r\n                };\r\n                RSTFileManager.open(options);\r\n            });\r\n        },\r\n\r\n        bytesToSize: function (bytes) {\r\n            let sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\r\n            if (bytes === 0) return '0 Byte';\r\n            let i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));\r\n            return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];\r\n        },\r\n\r\n        transformToAttachmentsModel: function (file, isPreview) {\r\n            const attachment = {\r\n                id: null,\r\n                preview: isPreview === 'true',\r\n                fileName: file.displayName || file.fileName,\r\n                extName: file.extension,\r\n                size: file.size,\r\n                type: file.type,\r\n                uniqID: file.uniqID,\r\n                uuid: file.uuid,\r\n            };\r\n\r\n            return attachment;\r\n        },\r\n\r\n        resetPreview: function () {\r\n            orgFormAttachs.IMAGE = orgFormAttachs.IMAGE.filter(function (item) {\r\n                if (item.preview === true && item.id) {\r\n                    $.ajax({\r\n                        headers: orgStruct.adminsHeaders,\r\n                        url: `${cr}/file/removeAttachment.action?id=${item.id}`,\r\n                        type: 'POST',\r\n                        processData: false,\r\n                        contentType: false\r\n                    });\r\n                }\r\n                return item.preview !== true;\r\n            });\r\n        },\r\n\r\n        renderPreview: function ($previewContainer, fileInfo) {\r\n            switch (fileInfo.type) {\r\n                case 'IMAGE':\r\n                    if (fileInfo.preview) {\r\n                        $previewContainer.empty();\r\n                    }\r\n                    $previewContainer.append(`\r\n                            <div class=\"preview-item\" data-extension=\"${fileInfo.extName}\" data-filename=\"${fileInfo.fileName}\" data-size=\"${fileInfo.size}\" data-uniqid=\"${fileInfo.uniqID}\" data-id=\"${fileInfo.id}\" data-uuid=\"${fileInfo.uuid}\" data-type=\"${fileInfo.type}\" data-path=\"${cr}/image-api/view.ido?uuid=${fileInfo.uuid}\">\r\n                                <img src=\"${cr}/image-api/view.ido?uuid=${fileInfo.uuid}\" class=\"preview-item__img\">\r\n                                <div class=\"preview-item__remove-btn\">\r\n                                    <svg>\r\n                                         <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"${cr}/sprite/sprite.svg#icon-close\"></use>\r\n                                    </svg>\r\n                                </div>\r\n                            </div>\r\n                     `);\r\n                    break;\r\n                case 'DOC':\r\n                    $previewContainer.append(`\r\n                            <div class=\"preview-item preview-item--doc\" data-extension=\"${fileInfo.extName}\" data-filename=\"${fileInfo.fileName}\" data-uniqid=\"${fileInfo.uniqID}\" data-size=\"${fileInfo.size}\" data-id=\"${fileInfo.id}\" data-uuid=\"${fileInfo.uuid}\" data-type=\"${fileInfo.type}\" data-path=\"${cr}/image-doc/view.ido?uuid=${fileInfo.uuid}\">\r\n                                <div class=\"preview-item__doc-pic\">\r\n                                    <svg>\r\n                                        <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"${cr}/sprite/sprite.svg#${fileInfo.extName.toLowerCase()}\"></use>\r\n                                    </svg>\r\n                                </div>\r\n                                <span class=\"preview-item__doc\">${fileInfo.fileName}</span>\r\n                                <div class=\"preview-item__remove-btn preview-item__remove-btn--transparent\">\r\n                                    <svg>\r\n                                          <use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"${cr}/sprite/sprite.svg#icon-close\"></use>\r\n                                       </svg>\r\n                                </div>\r\n                            </div>\r\n                    `);\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        },\r\n\r\n        requestForm: function () {\r\n            $.ajax({\r\n                headers: orgStruct.adminsHeaders,\r\n                url: (() => {\r\n                    const urlFunc = method => `${cr}/rest-api/orgStructure/${method}.action`;\r\n                    if (orgStruct.member) {\r\n                        return urlFunc('savePersonOrgan');\r\n                    }\r\n\r\n                    return orgStruct.organ ? urlFunc('saveOrgan') : urlFunc('savePerson');\r\n                })(),\r\n                dataType: 'json',\r\n                type: \"POST\",\r\n                data: JSON.stringify(fieldsValue),\r\n                statusCode: {\r\n                    200: function () {\r\n                        window.location.href = orgStruct.redirectUrl\r\n                    }\r\n                }\r\n            });\r\n        },\r\n\r\n        events: function () {\r\n            let that = this;\r\n\r\n            $form.submit(function (e) {\r\n                e.preventDefault();\r\n                that.checkInput();\r\n\r\n                if ($form.find('.error-info').length) {\r\n                    gostValidation.scrollToFirstError();\r\n                } else {\r\n                    that.requestForm();\r\n                }\r\n            });\r\n\r\n            $(document).on('click', '.preview-item__remove-btn', function () {\r\n                const $fileContainer = $(this).closest('.preview-item');\r\n                const fileType = $fileContainer.attr('data-type');\r\n                const fileID = parseInt($fileContainer.attr('data-id'), 10);\r\n                const fileUID = parseInt($fileContainer.attr('data-uuid'), 10);\r\n                if (fileID) {\r\n                    // $.ajax({\r\n                    //     url: `${cr}/file/uploadFile.action`,\r\n                    //     data: formData,\r\n                    //     type: 'POST',\r\n                    //     beforeSend: request => {\r\n                    //         request.setRequestHeader('gtn.access.appid', orgStruct.adminsHeaders['gtn.access.appid']);\r\n                    //     },\r\n                    //     processData: false,\r\n                    //     contentType: false,\r\n                    //     success: data => {\r\n                    //         orgFormAttachs[fileType] = orgFormAttachs[fileType]\r\n                    //             .filter(function (item) {\r\n                    //                 return item.id !== fileID;\r\n                    //             });\r\n                    //         $fileContainer.remove();\r\n                    //     },\r\n                    //     error: err => {\r\n                    //         console.log(err);\r\n                    //     },\r\n                    // });\r\n                    \r\n                    $fileContainer.remove();\r\n                } else {\r\n                    orgFormAttachs[fileType] = orgFormAttachs[fileType]\r\n                        .filter(function (item) {\r\n                            return item.uuid !== fileUID;\r\n                        });\r\n\r\n                    $fileContainer.remove();\r\n                }\r\n            });\r\n        },\r\n\r\n        addPhone: function () {\r\n            let that = this;\r\n            const $addPhone = $('.js-add-phone');\r\n            const $addPhoneBtn = $addPhone.find('._btn');\r\n\r\n            $addPhoneBtn.on('click', function () {\r\n                $addPhone.parent().append(`<div class=\"gost-form__value edit-field\"><input id=\"manager${$addPhone.parent().find('.gost-form__value').length}-phone\" type=\"text\" class=\"textbox form-field\" value=\"\">${that.renderEditBox(\"Удалить поле\")}</div>`);\r\n            });\r\n        },\r\n\r\n        renderEditBox: function (linkText) {\r\n            return `<div class=\"edit-box\"><button class=\"edit-box__btn\" type=\"button\"><svg><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"${cr}/sprite/sprite.svg#icon-settings\"></use></svg></button><ul class=\"edit-box__list\"><li class=\"_item\"><button class=\"_btn danger\" type=\"button\">${linkText}</button></li></ul></div>`;\r\n        },\r\n\r\n        addStructure: function () {\r\n            let that = this;\r\n            const list = $('.js-governments-list').html();\r\n            const $addStructure = $('.js-add-structure');\r\n            const $addStructureBtn = $addStructure.find('._btn');\r\n            const structureBlockHeader = `<div class=\"bunch__field\"><label class=\"gost-form__label\">Курируемое структурное подразделение</label><div class=\"gost-form__value edit-field\"><select class=\"js-select\" data-key=\"Курируемое структурное подразделение\">${list}</select>${that.renderEditBox(\"Удалить связку\")}</div></div>`;\r\n            const structureBlockBottom = '<div class=\"bunch__field\"><label class=\"gost-form__label\">Описание</label><input type=\"text\" class=\"textbox\" data-key=\"Описание\" value=\"\"></div>';\r\n            const structureBlock = `<div class=\"gost-form__bunch form-structure\">${structureBlockHeader} ${structureBlockBottom}</div>`;\r\n\r\n            $addStructureBtn.on('click', function () {\r\n                $addStructure.parent().find('.gost-form__section').append(structureBlock);\r\n                $('.js-select').selectmenu();\r\n            });\r\n        },\r\n\r\n        editBox: function () {\r\n            $(document).on('click', '.edit-box__btn', function () {\r\n                if ($(this).hasClass('active')) {\r\n                    $(this).removeClass('active');\r\n                    $(this).next().hide();\r\n                } else {\r\n                    $(this).addClass('active');\r\n                    $(this).next().show();\r\n                }\r\n            });\r\n\r\n            $(document).on('click', '.edit-box__list ._btn', function () {\r\n                if ($(this).parents('.gost-form__bunch').length) {\r\n                    $(this).parents('.gost-form__bunch').remove();\r\n                } else {\r\n                    $(this).parents('.edit-field').remove();\r\n                }\r\n            });\r\n\r\n            $(document).on('mouseup', e => {\r\n                const $dropdown = $('.edit-box__list');\r\n                if (!$dropdown.is(e.target) && $dropdown.has(e.target).length === 0) {\r\n                    $dropdown.hide();\r\n                }\r\n            });\r\n        },\r\n\r\n        init: function () {\r\n            this.events();\r\n            this.addPhone();\r\n            this.addStructure();\r\n            this.editBox();\r\n            this.addFiles();\r\n        }\r\n    };\r\n\r\n    const orgApp = {\r\n        tinyInit: function () {\r\n            tinymce.init({\r\n                selector: '.js-tiny-editor',\r\n                menubar: false,\r\n                statusbar: false,\r\n                relative_urls: false,\r\n                image_advtab: true,\r\n                mode: 'textareas',\r\n                external_plugins: {\r\n                    advlist: `${cr}/lib/tinymce/plugins/advlist/plugin.min.js`,\r\n                    lists: `${cr}/lib/tinymce/plugins/lists/plugin.min.js`,\r\n                    link: `${cr}/lib/tinymce/plugins/link/plugin.min.js`,\r\n                    visualchars: `${cr}/lib/tinymce/plugins/visualchars/plugin.min.js`,\r\n                    charmap: `${cr}/lib/tinymce/plugins/charmap/plugin.min.js`,\r\n                    image: `${cr}/lib/tinymce/plugins/image/plugin.min.js`,\r\n                    paste: `${cr}/lib/tinymce/plugins/paste/plugin.min.js`,\r\n                },\r\n                plugins: 'lists advlist link paste',\r\n                toolbar1: `undo redo fontsizeselect | bold italic underline strikethrough | subscript superscript forecolor backcolor | alignleft aligncenter alignright alignjustify  | ' +\r\n                'outdent indent | numlist bullist  | customlink | removeformat | photoupload videoupload fileupload`,\r\n                body_class: 'mce-body',\r\n                language_url: `${cr}/lib/tinymce/langs/ru.js`,\r\n                content_css: `/eXoResources/plugins/tinymce/skins/lightgray/content.min.css?v=${orgStruct.versionUI}, /eXoResources/plugins/tinymce/skins/lightgray/content.RST.css?v=${orgStruct.versionUI}`,\r\n                skin_url: '/eXoResources/plugins/tinymce/skins/lightgray',\r\n                advlist_bullet_styles: 'disc',\r\n                paste_use_dialog: false,\r\n                paste_auto_cleanup_on_paste: true,\r\n                paste_convert_headers_to_strong: false,\r\n                paste_strip_class_attributes: 'all',\r\n                paste_remove_spans: true,\r\n                paste_remove_styles: true,\r\n                paste_retain_style_properties: '',\r\n                style_formats: [\r\n                    { title: 'Headers',\r\n                        items: [\r\n                            { title: 'Заголовок 1', block: 'h2' },\r\n                            { title: 'Заголовок 2', block: 'h3' },\r\n                            { title: 'Заголовок 3', block: 'h4' },\r\n                        ] },\r\n                    { title: 'Blocks',\r\n                        items: [\r\n                            { title: 'Параграф', format: 'p' },\r\n                        ] },\r\n                ],\r\n                setup: function setUp(editor) {\r\n                    editor.addButton('photoupload', {\r\n                        icon: 'image',\r\n                        tooltip: 'Прикрепить фото',\r\n                        onclick() {\r\n                            const options = {\r\n                                appId: orgStruct.appId,\r\n                                portalName: orgStruct.portalName,\r\n                                appName: orgStruct.appName,\r\n                                allowedFileFormats: ['img'],\r\n                                onClose: function close() {\r\n                                    const selectedFiles = RSTFileManager.getFiles();\r\n                                    selectedFiles.forEach(function (file) {\r\n                                        editor.insertContent(`<img src=\"${cr}/image-api/view.ido?uuid=${file.uuid}\" data-uuid=\"${file.uuid}\"/>`);\r\n                                    });\r\n                                },\r\n                            };\r\n                            RSTFileManager.open(options);\r\n                        },\r\n                    });\r\n                    \r\n                    editor.addButton('videoupload', {\r\n                        icon: 'media',\r\n                        tooltip: 'Прикрепить видео',\r\n                        onclick() {\r\n                            const options = {\r\n                                appId: orgStruct.appId,\r\n                                portalName: orgStruct.portalName,\r\n                                appName: orgStruct.appName,\r\n                                allowedFileFormats: ['video'],\r\n                                onClose() {\r\n                                    const selectedFiles = RSTFileManager.getFiles();\r\n                                    selectedFiles.forEach(function (file) {\r\n                                        editor.insertContent(`                                            \r\n                                                        <video width=\"320\" height=\"240\" controls data-uuid=\"${file.uuid}\">\r\n                                                            <source src=\"${cr}/media-api/view.media?uuid=${file.uuid}\" type=\"video/mp4\">\r\n                                                            <source src=\"${cr}/media-api/view.media?uuid=${file.uuid}\" type=\"video/ogg\">\r\n                                                            Your browser does not support the video tag.\r\n                                                         </video>\r\n                                                    `);\r\n                                    });\r\n                                },\r\n                            };\r\n                            RSTFileManager.open(options);\r\n                        },\r\n                    });\r\n    \r\n                    editor.addButton('fileupload', {\r\n                        icon: 'newdocument',\r\n                        tooltip: 'Прикрепить документ',\r\n                        onclick() {\r\n                            const options = {\r\n                                appId: orgStruct.appId,\r\n                                portalName: orgStruct.portalName,\r\n                                appName: orgStruct.appName,\r\n                                allowedFileFormats: ['doc', 'archive', 'text'],\r\n                                onClose() {\r\n                                    const selectedFiles = RSTFileManager.getFiles();\r\n                                    selectedFiles.forEach(function (file) {\r\n                                        editor.insertContent(`\r\n                                            <a href=\"/documentManager/rest/file/load/${file.uuid}\" data-uuid=\"${file.uuid}\">${file.displayName || file.fileName}</a>\r\n                                            <span class=\"tiny-content__file-size\">(${file.extension} , ${(file.size / 10 / 1024 / 1024).toFixed(2)} Мб)</span>\r\n                                        `);\r\n                                    });\r\n                                },\r\n                            };\r\n                            RSTFileManager.open(options);\r\n                        },\r\n                    });\r\n                },\r\n            });\r\n        },\r\n\r\n        init: function () {\r\n            this.tinyInit();\r\n\r\n            $('.js-select').selectmenu();\r\n\r\n            $('.gost-form .datepckr__input').each(function () {\r\n                const $el = $(this);\r\n                const val = $el.data('date') || null;\r\n\r\n                if(val) {\r\n                    $el.gostDatepicker();\r\n                    setTimeout(() => {\r\n                        $el.datepicker('setDate', $.datepicker.parseDate( \"dd.mm.yy\", val ));\r\n                    }, 0);\r\n                } else {\r\n                    $el.gostDatepicker();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    $(document).ready(function () {\r\n        orgApp.init();\r\n        orgForm.init();\r\n    });\r\n});\r\n"]}